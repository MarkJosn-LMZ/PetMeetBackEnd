# PetMeet AI用户生成功能使用说明

## 功能概述

PetMeet帖文管理系统现已支持通过AI自动生成用户信息并添加到数据库中，大大简化了测试用户的创建过程。

## 主要功能

### 1. AI生成用户信息
- **功能**：使用AI模型自动生成完整的用户资料
- **按钮**：🤖 AI生成用户
- **生成内容**：
  - 28位标准微信OpenID格式（如：oK4cF7BXUaKgYPItC7lO245TxSe0d）
  - 9位数字PetMeetID（通过后端算法生成）
  - 有趣的宠物相关昵称
  - 随机头像URL
  - 50字以内的个人简介
  - 随机性别
  - 中国城市和省份
  - 其他基础信息

### 2. 添加新用户到数据库
- **功能**：将生成或手动填写的用户信息保存到数据库
- **按钮**：➕ 添加新用户
- **验证**：自动检查OpenID是否已存在
- **确认**：添加前会弹出确认对话框

### 3. 用户列表管理
- **功能**：显示数据库中所有用户
- **按钮**：加载用户信息
- **特性**：
  - 实时显示用户数量
  - 点击用户可快速选择
  - 显示用户详细信息（头像、昵称、地区、创建时间等）

## 使用流程

### 快速生成并添加用户

1. **配置AI参数**（右侧AI配置区域）
   - 选择API Key环境变量（推荐：TENCENT_AI_API_KEY）
   - 选择Base URL（推荐：DeepSeek腾讯云）
   - 选择模型（推荐：deepseek-r1）

2. **测试AI连接**
   - 点击"🔗 测试连接"按钮
   - 确保显示"AI连接测试成功"

3. **生成用户信息**
   - 点击"🤖 AI生成用户"按钮
   - 等待AI生成完成
   - 查看自动填充的用户信息

4. **添加到数据库**
   - 点击"➕ 添加新用户"按钮
   - 确认添加操作
   - 等待添加完成

5. **验证结果**
   - 点击"加载用户信息"按钮
   - 在用户列表中查看新添加的用户

### 手动创建用户

1. **填写用户信息**
   - 手动输入OpenID、昵称等必要信息
   - 填写可选的个人简介、性别、地区等

2. **保存并添加**
   - 点击"保存用户信息"（本地保存）
   - 点击"➕ 添加新用户"（保存到数据库）

## 技术特性

### AI模型支持
- **腾讯云混元**：hunyuan-turbos-latest
- **DeepSeek**：deepseek-r1, deepseek-reasoner
- **豆包**：doubao-1-5-thinking-pro
- **OpenAI**：gpt-4, gpt-3.5-turbo

### ID生成算法
- **OpenID格式**：标准微信openid格式，28位字符，以'o'开头
- **PetMeetID生成**：使用雪花算法生成唯一ID，通过映射表转换为9位数字
- **映射存储**：ID映射关系存储在数据库中，支持双向查询

### 数据验证
- OpenID唯一性检查
- 必要字段验证
- 数据格式校验

### 错误处理
- 详细的错误信息显示
- 网络连接问题诊断
- AI服务状态检查

### 安全特性
- 环境变量方式管理API Key
- JWT令牌认证
- 数据库事务处理

## 生成的用户数据示例

```json
{
  "_openid": "oK4cF7BXUaKgYPItC7lO245TxSe0d",
  "PetMeetID": "123456789",
  "nickName": "🐾布偶猫驯养员🍼",
  "avatarUrl": "https://via.placeholder.com/100x100?text=布",
  "bio": "家有3只布偶猫的资深铲屎官｜宠物烘焙达人｜记录毛孩子的治愈日常",
  "gender": "female",
  "city": "成都",
  "province": "四川省",
  "birthday": "1992-05-15",
  "status": "active",
  "isAIGenerated": true,
  "aiModel": "deepseek-r1"
}
```

## 常见问题

### Q: AI生成失败怎么办？
A: 
1. 检查AI配置是否正确
2. 测试AI连接状态
3. 确认API配额充足
4. 尝试其他AI模型

### Q: 用户添加失败怎么办？
A:
1. 检查OpenID是否已存在
2. 确认必要字段已填写
3. 检查数据库连接状态
4. 查看详细错误信息

### Q: 如何批量生成用户？
A: 可以重复执行"AI生成用户"→"添加新用户"的流程，每次生成的OpenID都是唯一的。

## 系统要求

- Node.js 环境
- 腾讯云数据库访问权限
- AI服务API Key配置
- 端口3001可用

## 访问地址

- 管理系统：http://localhost:3001
- 用户列表API：http://localhost:3001/api/users/all
- 添加用户API：http://localhost:3001/api/users/add

---

*最后更新：2025-05-28* 